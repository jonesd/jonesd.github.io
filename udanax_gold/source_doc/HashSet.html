<html>
<html>
<head>
<title>Class HashSet</title>
</head><body>
<a href="index.html">Index</a> - <a href="AllPackages.html">All Packages</a> - <a href="AllCategories.html">All Categories</a> - <a href="AllClasses.html">All Classes</a><br><h1>Class HashSet</h1>
<font color="green">	The <a href="HashSet.html">HashSet</a> class is an implementation of a <a href="MuTable.html">MuTable</a> set that can contain arbitrary <a href="Heaper.html">Heapers</a>.  It uses the hashForEqual member function to get a hash value for the items contained in the set.  The set establishes the equality of objects in the set through the isEqual: function.<br>	<br>	The implemention of <a href="HashSet.html">HashSet</a> is straightforward.  There are primitive tables used to store pointers to the stored items (myHashEntries), and their corresponding hash values (myHashValues).  The <a href="HashSet.html">HashSet</a> also maintain a current tally of the number of items in the set.<br>	<br>	definition: preferred location - the location calculated from item hashForEqual mod tableSize.<br>	<br>	The search routine first calculates the preferred location.  This is used as the first location in the myHashEntries table to test for the presence of the item, and the search proceeds forward (in a linear probe) from there.  If there is no object at that position, the routine assumes the item is not in the table.  If there is an item there, the first test is to check if the item's hash matches the hash myHashValues at that position.  If the match is successful, a full isEqual: test is performed.  If the isEqual: test succeeds, the item is present in the set.  If either test fails, the entry at the desired location is tested to see if it is closer to its own preferred location than the item (a test which necessarily fails the first time).  If it is closer, the item is not in the set.  (This extra test is what distinguishes an ordered hash set from an ordinary hash set.  It often detects the absense of an item well before an empty slot is encountered, and the advantage becomes pronounced as the set fills up.  Ordered hash sets with linear probe beat ordinary hash sets with secondary clustering on misses (the big time eater), yet they preserve linear probe's easy deletion.)<br>	<br>	On insertion to the set, the hash and probe sequence is essentially the same as the search.  The main exception is that on a hash collision, the item bumps down any item that is no farther than its own preferred position.<br>	<br>	An example is perhaps in order:<br>	<br>	the set contains items a, b, and c in table locations 3, 4, and 5.  Assume that a has location 2 as its preferred location, while b and c both have location 4 as their preferred location.  Now, if we attempt to add an item d to the table, and item d were to have a preferred location of 3.  Since 3 is already occupied by something that is already far from its preferred location, we probe for a another location.  At location 4, item d is displaced by one from its preferred location.  Since b is in it's preferred location (4) d replaces it, and we move item b down.  Item c is in location 5 because it had already been bumped from location 4 when b was inserted previously.  B again ties with c, so it pushes it out of location 5, replacing it there.  Item c will end up in location 6.  This probe function minimizes the individual displacement of hash misses, while keeping the most items in their preferred locations.<br>	<br>	Note that, though the choice of which item to bump is obvious when the distances from home are different, when they are equal we could have given preference to either the new or the old item.  We chose to put the new item closer to its preferred location, on the assumption that things entered recently are more likely to be looked up than things entered long ago.<br>	<br>This algorithm was derived from a short discussion with Michael McClary (probably completely missing his intended design - all mistakes are mine -- heh).<br><br>(Unfortunately, I wasn't clear in the discussion.  Since hugh was unavailable when I discovered this, I've taken the opportunity to practice with Smalltalk and corrected both the explanation and the code rather than sending him a clarification. -- michael)<br></font></p>Package: <a href="Package_Udanax-Gold.html">Udanax-Gold</a><br>All Superclasses: <a href="Object.html">Object</a> <a href="Heaper.html">Heaper</a> <a href="ScruSet.html">ScruSet</a> <a href="MuSet.html">MuSet</a> <br>Immediate Subclasses: <a href="ActualHashSet.html">ActualHashSet</a> <br>Protocols: <a href="Protocol_Object.html">Object</a><br>Categories: <a href="Category_Xanadu-Collection-Sets.html">Xanadu-Collection-Sets</a><br><hr><h2>Class Methods</h3><a name="#make"><h4><font color="blue">make</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#make">MuSet class</a><br>Overridden by: <a href="ActualHashSet.html#make">ActualHashSet class</a> </blockquote><a name="#makeHeaper:"><h4><font color="blue">makeHeaper:</font> something </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#makeHeaper:">MuSet class</a><br>Overridden by: <a href="ActualHashSet.html#makeHeaper:">ActualHashSet class</a> </blockquote><a name="#makeIntegerVar:"><h4><font color="blue">makeIntegerVar:</font> someSize </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#makeIntegerVar:">MuSet class</a><br>Overridden by: <a href="ActualHashSet.html#makeIntegerVar:">ActualHashSet class</a> </blockquote><hr><h2>Instance Methods</h3><a name="#asImmuSet"><h4><font color="blue">asImmuSet</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#asImmuSet">MuSet</a></blockquote><a name="#asMuSet"><h4><font color="blue">asMuSet</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#asMuSet">MuSet</a></blockquote><a name="#copy"><h4><font color="blue">copy</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#copy">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#copy">ActualHashSet</a> </blockquote><a name="#count"><h4><font color="blue">count</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#count">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#count">ActualHashSet</a> </blockquote><a name="#hasMember:"><h4><font color="blue">hasMember:</font> someone </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#hasMember:">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#hasMember:">ActualHashSet</a> </blockquote><a name="#immuStepper"><h4><font color="blue">immuStepper</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#immuStepper">MuSet</a></blockquote><a name="#introduce:"><h4><font color="blue">introduce:</font> anElement </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#introduce:">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#introduce:">ActualHashSet</a> </blockquote><a name="#isEmpty"><h4><font color="blue">isEmpty</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#isEmpty">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#isEmpty">ActualHashSet</a> </blockquote><a name="#printInternals:"><h4><font color="blue">printInternals:</font> oo </h4></a><blockquote><font color="green"><br></font><br>Overridden by: <a href="ActualHashSet.html#printInternals:">ActualHashSet</a> </blockquote><a name="#remove:"><h4><font color="blue">remove:</font> anElement </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#remove:">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#remove:">ActualHashSet</a> </blockquote><a name="#stepper"><h4><font color="blue">stepper</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="MuSet.html#stepper">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#stepper">ActualHashSet</a> </blockquote><a name="#store:"><h4><font color="blue">store:</font> anElement </h4></a><blockquote><font color="green">Add anElement to my set of members.  No semantic effect if anElement is already a member.<br></font><br>Overrides: <a href="MuSet.html#store:">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#store:">ActualHashSet</a> </blockquote><a name="#theOne"><h4><font color="blue">theOne</font> </h4></a><blockquote><font color="green"><br></font><br>Overrides: <a href="ScruSet.html#theOne">ScruSet</a><br>Overridden by: <a href="ActualHashSet.html#theOne">ActualHashSet</a> </blockquote><a name="#wipe:"><h4><font color="blue">wipe:</font> anElement </h4></a><blockquote><font color="green">make anElement no longer be one of my members.  No semantic effect if it already isn't a member.<br></font><br>Overrides: <a href="MuSet.html#wipe:">MuSet</a><br>Overridden by: <a href="ActualHashSet.html#wipe:">ActualHashSet</a> </blockquote><br><br><a href="index.html">Index</a> - <a href="AllPackages.html">All Packages</a> - <a href="AllCategories.html">All Categories</a> - <a href="AllClasses.html">All Classes</a><br></body>
</html>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5004449-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</body>
</html>
